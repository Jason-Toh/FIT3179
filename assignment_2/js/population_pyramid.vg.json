{
   "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
   "background":"#B7E9F7",
   "data":{
      "url":"https://raw.githubusercontent.com/Jason-Toh/FIT3179/main/assignment_2/data/nyc_crime_filtered.csv"
   },
   "params":[
      {
         "name":"current_year",
         "value":2006,
         "bind":{
            "input":"range",
            "min":2006,
            "max":2019,
            "step":1,
            "name":"Year Onwards: "
         }
      }
   ],
   "transform":[
      {
          "calculate":"{'M':'Male','F':'Female'}[datum.perp_sex]",
          "as":"gender"
       },
      {
         "filter":{
            "timeUnit":"year",
            "field":"arrest_date",
            "gte":"current_year"
         }
      }
   ],
   "spacing":0,
   "hconcat":[
      {
         "transform":[
            {
               "filter":{
                  "field":"perp_sex",
                  "equal":"M"
               }
            }
         ],
         "width":250,
         "height":200,
         "title":"Male",
         "mark":"bar",
         "encoding":{
            "y":{
               "field":"age_group",
               "axis":null,
               "sort":[
                  "65+",
                  "45-64",
                  "25-44",
                  "18-24",
                  "<18"
               ]
            },
            "x":{
               "aggregate":"count",
               "field":"arrest_key",
               "title":"Number of offences",
               "axis":{
                  "format":"s"
               },
               "scale":{
                  "domain":[
                     0,
                     20000
                  ]
               },
               "sort":"descending"
            },
            "color":{
               "field":"perp_sex",
               "scale":{
                  "range":[
                     "#AE2D68",
                     "#422680"
                  ]
               },
               "legend":null
            },
            "tooltip":[
               {
                  "field":"gender",
                  "type":"nominal",
                  "title":"Gender"
               },
               {
                  "field":"arrest_key",
                  "aggregate":"count",
                  "type":"quantitative",
                  "title":"Offence Count"
               }
            ]
         }
      },
      {
         "width":20,
         "height":200,
         "view":{
            "stroke":null
         },
         "mark":{
            "type":"text",
            "align":"center"
         },
         "encoding":{
            "y":{
               "field":"age_group",
               "type":"ordinal",
               "axis":null,
               "sort":[
                  "65+",
                  "45-64",
                  "25-44",
                  "18-24",
                  "<18"
               ]
            },
            "text":{
               "field":"age_group",
               "type":"ordinal"
            }
         }
      },
      {
         "transform":[
            {
               "filter":{
                  "field":"perp_sex",
                  "equal":"F"
               }
            }
         ],
         "width":250,
         "height":200,
         "title":"Female",
         "mark":"bar",
         "encoding":{
            "y":{
               "field":"age_group",
               "title":null,
               "axis":null,
               "sort":[
                  "65+",
                  "45-64",
                  "25-44",
                  "18-24",
                  "<18"
               ]
            },
            "x":{
               "aggregate":"count",
               "field":"arrest_key",
               "title":"Number of Offences",
               "axis":{
                  "format":"s"
               },
               "scale":{
                  "domain":[
                     0,
                     20000
                  ]
               }
            },
            "color":{
               "field":"gender",
               "legend":null
            },
            "tooltip":[
               {
                  "field":"gender",
                  "type":"nominal",
                  "title":"Gender"
               },
               {
                  "field":"arrest_key",
                  "aggregate":"count",
                  "type":"quantitative",
                  "title":"Offence Count"
               }
            ]
         }
      }
   ]
}